<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles/styleIndex.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <title>Norme - equo compenso</title>
</head>
<body>

    <header>

        <section class="header-img">
            <img src="img/logo2.png" alt="logo">
        </section>

        <div class="ls">
            <ul>
                <li><a href="index.html">home</a></li>
                <li><a href="chi-siamo.html">chi siamo</a></li>
                <li><a href="calcola.html">calcola</a></li>
                <li><a href="norme.html">norme</a></li>
                <li><button onclick="window.location.href='index.html?login=1'">login</button></li>
                <li><button onclick="window.location.href='index.html?register=1'">registrati</button></li>
            </ul>
        </div>

    </header>
    
    <main>

        <div class="cointener">
            <div class="hero">
                <h2>Legge 21 aprile 2023, n. 49</h2>
                <p>Disposizioni in materia di equo compenso delle prestazioni professionali</p>
                <p>gazzetta ufficiale della repubblica italiana – serie generale n. 104 del 5 maggio 2023. legge 21 aprile 2023, n. 49: disposizioni in materia di equo compenso per le prestazioni professionali. la camera dei deputati e il senato della repubblica hanno approvato; il presidente della repubblica promulga la seguente legge.
                </p>
                <button class="inizia"><a href="https://www.gazzettaufficiale.it/atto/vediMenuHTML?atto.dataPubblicazioneGazzetta=2023-05-05&atto.codiceRedazionale=23G00051&tipoSerie=serie_generale&tipoVigenza=originario">scopri la normativa</a></button>
            </div>

            
            <div class="hero-img">
                <img src="img/uomini.png" alt="">
            </div>
        </div>

       

        <div class="section-divider"></div>

        <div class="cointener">
            <div class="norme-content">

                <section class="card-norme" id="enciclopedia">
                    <h2>Enciclopedia Equo Compenso – Dottori Commercialisti</h2>
                    <div class="divider"></div>
                    <p>Questa sezione riassume, in forma operativa, le principali prestazioni e i criteri di determinazione del compenso secondo i parametri ministeriali applicati dal calcolatore.</p>
                    <p><strong>Nota pratica:</strong> la determinazione segue le aliquote a scaglioni e può essere ulteriormente modulata da criterio (Min/Medio/Max) e dall'eventuale percentuale come posizionamento nel range ministeriale.</p>
                </section>

                <section class="card-norme" id="art-18">
                    <h2>Art. 18 – Maggiorazioni e Riduzioni</h2>
                    <div class="divider"></div>
                    <p>Definisce le variazioni del compenso:</p>
                    <ul>
                        <li><strong>Maggiorazioni</strong>: aumento fino al 100% per pratiche eccezionali o urgenza.</li>
                        <li><strong>Riduzioni</strong>: riduzione fino al 50% per prestazioni semplici.</li>
                    </ul>
                </section>

                <section class="card-norme" id="art-19">
                    <h2>Art. 19 – Amministrazione e Custodia (Riquadro 1)</h2>
                    <div class="divider"></div>
                    <p>Compenso basato sulla sommatoria di:</p>
                    <ul>
                        <li><strong>Componenti positivi di reddito lordo</strong></li>
                        <li><strong>Totale attività</strong></li>
                    </ul>
                    <p>Applicazione di aliquote a scaglioni (indicativamente dal 4% all'1%) con logica progressiva.</p>
                </section>

                <section class="card-norme" id="art-20">
                    <h2>Art. 20 – Liquidazione di Aziende (Riquadro 2)</h2>
                    <div class="divider"></div>
                    <p>Calcolo basato sulla sommatoria di:</p>
                    <ul>
                        <li><strong>Attivo realizzato</strong> (aliquote decrescenti, es. 4%–0,75%)</li>
                        <li><strong>Passivo accertato</strong> (aliquote decrescenti, es. 0,75%–0,50%)</li>
                    </ul>
                    <p>Il compenso complessivo deriva dalla somma delle due componenti calcolate per scaglioni.</p>
                </section>

                <section class="card-norme" id="art-21">
                    <h2>Art. 21 – Perizie e Valutazioni (Riquadro 3)</h2>
                    <div class="divider"></div>
                    <p>Determinazione in funzione del valore risultante dalla stima, con aliquote decrescenti su più scaglioni.</p>
                </section>

                <section class="card-norme" id="art-22">
                    <h2>Art. 22 – Revisioni Contabili (Riquadro 4)</h2>
                    <div class="divider"></div>
                    <p>Sommatoria di tre parametri:</p>
                    <ul>
                        <li><strong>Reddito lordo</strong></li>
                        <li><strong>Totale attività</strong></li>
                        <li><strong>Totale passività</strong></li>
                    </ul>
                    <p>Il compenso è calcolato applicando le aliquote previste dal decreto ai valori/scaglioni, sommando le tre componenti.</p>
                </section>

                <section class="card-norme" id="art-23">
                    <h2>Art. 23 – Tenuta della Contabilità (Riquadri 5.1 e 5.2)</h2>
                    <div class="divider"></div>
                    <p><strong>5.1 – Contabilità ordinaria:</strong> si sommano reddito lordo, attività e passività, applicando le aliquote a scaglioni.</p>
                    <p><strong>5.2 – Contabilità semplificata:</strong> applicazione di scaglioni sul solo reddito lordo.</p>
                </section>

                <section class="card-norme" id="art-24">
                    <h2>Art. 24 – Formazione del Bilancio (Riquadro 6)</h2>
                    <div class="divider"></div>
                    <p>Parametrato su reddito lordo, attività e passività con logica a scaglioni coerente con i parametri ministeriali.</p>
                </section>

                <section class="card-norme" id="art-25">
                    <h2>Art. 25 – Operazioni Societarie (Riquadri 7.1 e 7.2)</h2>
                    <div class="divider"></div>
                    <p><strong>7.1 – Costituzione:</strong> compenso basato sul capitale sottoscritto.</p>
                    <p><strong>7.2 – Operazioni straordinarie:</strong> compenso basato sul totale delle attività delle situazioni patrimoniali.</p>
                </section>

                <section class="card-norme" id="art-26">
                    <h2>Art. 26 – Consulenza Contrattuale e Finanziaria (Riquadri 8.1 e 8.2)</h2>
                    <div class="divider"></div>
                    <p><strong>8.1:</strong> determinazione sul corrispettivo pattuito (o sul valore contrattuale indicato), secondo le fasce previste.</p>
                    <p><strong>8.2:</strong> determinazione sul capitale mutuato/erogato/finanziato secondo la tabella ministeriale.</p>
                </section>

                <section class="card-norme" id="art-27">
                    <h2>Art. 27 – Procedure Concorsuali (Riquadro 9)</h2>
                    <div class="divider"></div>
                    <p>Liquidazione in funzione del totale delle passività.</p>
                    <p>In caso di <strong>esito negativo</strong> è prevista la riduzione fino al 50%.</p>
                </section>

                <section class="card-norme" id="art-28">
                    <h2>Art. 28 – Assistenza e Rappresentanza Tributaria (Riquadri 10.1, 10.2, 10.3)</h2>
                    <div class="divider"></div>
                    <ul>
                        <li><strong>10.1</strong>: tariffe fisse per adempimenti/atti (dichiarazioni, invii telematici, comunicazioni).</li>
                        <li><strong>10.2</strong>: percentuale sul valore della pratica con range (indicativamente 1%–5%), modulato da criterio e percentuale di posizionamento nel range.</li>
                        <li><strong>10.3</strong>: percentuali per ricorsi/consulenza su imposte, sanzioni e interessi, secondo le aliquote previste.</li>
                    </ul>
                </section>

                <section class="card-norme" id="art-29">
                    <h2>Art. 29 – Sindaco di Società (Riquadro 11)</h2>
                    <div class="divider"></div>
                    <p>Calcolato su reddito lordo e attività.</p>
                    <p>Variazioni per la carica:</p>
                    <ul>
                        <li><strong>Sindaco Unico</strong>: +100%</li>
                        <li><strong>Presidente</strong>: +50%</li>
                    </ul>
                </section>

            </div>
        </div>

        <div class="section-divider"></div>


    </main>
    
    <footer>
        <div class="footer-content">
            <p>&copy; 2025 equocompenso. All rights reserved.</p>
        </div>
    </footer>

    <script>
        function parseJwt(token) {
            if (!token || typeof token !== 'string') return {};
            const parts = token.split('.');
            if (parts.length !== 3) return {};
            try {
                return JSON.parse(atob(parts[1].replace(/-/g, '+').replace(/_/g, '/')));
            } catch {
                return {};
            }
        }

        async function updateHeaderUser() {
            const token = localStorage.getItem('authToken');
            const user = parseJwt(token);
            const headerUl = document.querySelector('.ls ul');
            if (!headerUl) return;
            const isLogged = !!token && (!!user.sub || !!user.id || !!user.email);

            function initialsFrom(u) {
                const nome = (u && u.nome ? String(u.nome) : '').trim();
                const cognome = (u && u.cognome ? String(u.cognome) : '').trim();
                if (nome || cognome) {
                    return `${nome.charAt(0)}${cognome.charAt(0)}`.toUpperCase();
                }
                const email = (u && u.email ? String(u.email) : '').trim();
                if (email) return email.charAt(0).toUpperCase();
                return 'U';
            }

            async function syncNavAvatar() {
                const img = document.getElementById('nav-user-photo');
                const initials = document.querySelector('.nav-user-initials');
                if (!img || !initials) return;

                let u = user || {};
                try {
                    const me = await fetch('/api/me', {
                        method: 'GET',
                        headers: { Authorization: `Bearer ${token}` }
                    });
                    if (me.ok) {
                        const data = await me.json();
                        if (data && data.user) u = data.user;
                    }
                } catch {
                    u = user || {};
                }

                const avatarUrl = u && u.avatar_url ? String(u.avatar_url) : '';
                if (avatarUrl) {
                    const normalized = (/^https?:\/\//i.test(avatarUrl) || avatarUrl.startsWith('/'))
                        ? avatarUrl
                        : `/${avatarUrl}`;
                    img.onerror = () => {
                        img.removeAttribute('src');
                        img.style.display = 'none';
                        initials.textContent = initialsFrom(u);
                        initials.style.display = '';
                    };
                    img.src = normalized;
                    img.style.display = '';
                    initials.style.display = 'none';
                } else {
                    img.removeAttribute('src');
                    img.style.display = 'none';
                    initials.textContent = initialsFrom(u);
                    initials.style.display = '';
                }
            }

            function isAuthLi(li) {
                const txt = (li.textContent || '').trim().toLowerCase();
                if (txt === 'login' || txt === 'registrati') return true;
                const btn = li.querySelector('button');
                if (btn && btn.onclick) {
                    const fn = btn.onclick.toString();
                    if (fn.includes('login') || fn.includes('openRegisterModal') || fn.includes('register')) return true;
                }
                const a = li.querySelector('a');
                if (a) {
                    const href = (a.getAttribute('href') || '').toLowerCase();
                    if (href.includes('login') || href.includes('register')) return true;
                }
                return false;
            }

            if (isLogged) {
                headerUl.querySelectorAll('li').forEach(li => {
                    if (isAuthLi(li)) li.style.display = 'none';
                });
                if (!headerUl.querySelector('.user-item')) {
                    const userLi = document.createElement('li');
                    userLi.className = 'user-item';
                    userLi.innerHTML = `
                        <div class="user-dropdown">
                            <button class="user-btn" onclick="toggleUserDropdown(event)">
                                <span class="user-avatar"><img id="nav-user-photo" class="nav-user-photo" alt="Foto profilo"><span class="nav-user-initials"></span></span>
                                <span class="user-welcome-text">Ciao, ${user.nome || user.email || ''}</span>
                            </button>
                            <div id="userDropdownMenu" class="user-dropdown-menu">
                                <div class="user-menu-info">
                                    <div class="user-menu-avatar-lg"><i class="fas fa-user"></i></div>
                                    <div>
                                        <div class="user-menu-name">${(user.nome || '').trim() ? `Ciao, ${user.nome}` : 'Account'}</div>
                                        <div class="user-menu-email">${user.email || ''}</div>
                                    </div>
                                </div>
                                <div class="user-menu-items">
                                    <button class="user-menu-item" onclick="window.location.href='dashboard.html?view=profile'"><i class="fas fa-user"></i><span>Il mio Profilo</span></button>
                                    <button class="user-menu-item" onclick="window.location.href='dashboard.html?view=calculations'"><i class="fas fa-history"></i><span>I miei Calcoli</span></button>
                                    <button class="user-menu-item" onclick="window.location.href='dashboard.html?view=security'"><i class="fas fa-gear"></i><span>Impostazioni</span></button>
                                </div>
                                <div class="user-menu-footer">
                                    <button class="user-menu-item danger" onclick="handleLogout()"><i class="fas fa-right-from-bracket"></i><span>Esci / Logout</span></button>
                                </div>
                            </div>
                        </div>
                    `;
                    headerUl.appendChild(userLi);
                }
                await syncNavAvatar();
            } else {
                headerUl.querySelectorAll('li').forEach(li => {
                    if (isAuthLi(li)) li.style.display = '';
                });
                const userLi = headerUl.querySelector('.user-item');
                if (userLi) userLi.remove();
            }
        }

        function toggleUserDropdown(event) {
            if (event) event.stopPropagation();
            const menu = document.getElementById('userDropdownMenu');
            if (!menu) return;
            menu.classList.toggle('open');
        }

        function handleLogout() {
            localStorage.removeItem('authToken');
            updateHeaderUser();
            window.location.href = 'index.html';
        }

        function openProfileModal() {
            window.location.href = 'index.html?profile=1';
        }

        document.addEventListener('click', function(event) {
            if (!event.target.closest('.user-dropdown')) {
                const menu = document.getElementById('userDropdownMenu');
                if (menu) menu.classList.remove('open');
            }
        });

        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const menu = document.getElementById('userDropdownMenu');
                if (menu) menu.classList.remove('open');
            }
        });

        (function() {
            updateHeaderUser();
        })();
    </script>

</body>
</html>
